<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body style="background: cadetblue">
    <h2>Submitted Scope 3 Emission Entries</h2>

    <form method="get" style="margin-bottom: 20px; text-align: center;">
        Supplier:
        <label>
            <select name="supplier">
                <option value="">All</option>
                {% for supplier in suppliers %}
                    <option value="{{ supplier.id }}" {% if supplier.id|stringformat:"s" == request.GET.supplier %} selected {% endif %}>{{ supplier.name }}</option>
                {% endfor %}
            </select>
        </label>

        Verified:
        <select name="verified">
            <option value="">All</option>
            <option value="true" {% if request.GET.verified == "true" %} selected {% endif %}>Verified</option>
            <option value="false" {% if request.GET.verified == "false" %} selected {% endif %}>Unverified</option>
        </select>

        <button type="submit">Filter</button>
    </form>

    <table border="1" cellpadding="8" style="width: 80%; margin: auto;">
        <tr style="background: #e6ffe6;">
            <th>Supplier</th>
            <th>Date Reported</th>
            <th>CO₂ Emissions (tons)</th>
            <th>File</th>
            <th>Notes</th>
            <th>Verified</th>
        </tr>
        {% for entry in page_obj %}
        <tr>
            <td>{{ entry.supplier.name }}</td>
            <td>{{ entry.date_reported }}</td>
            <td>{{ entry.scope3_emissions }}</td>
            <td>
                {% if entry.evidence_file %}
                    <a href="{{ entry.evidence_file.url }}">View</a>
                {% else %}
                    -
                {% endif %}
            </td>
            <td>{{ entry.notes }}</td>
            <td>{% if entry.verified %} ✔️ {% else %} ❌ {% endif %}</td>
        </tr>
        {% empty %}
        <tr><td colspan="6">No submissions found.</td></tr>
        {% endfor %}
        <div style="text-align: center">
            {% if page_obj.has_previous %}
                <a href="?{% if request.GET.supplier %} supplier = {{ request.GET.supplier }} & {% endif %} {% if request.GET.verified %} verified = {{ request.GET.verified }} & {% endif %} page={{ page_obj.previous_page_number }}">Prev</a>
            {% endif %}

            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
            {% if page_obj.has_next %}
                <a href="?{% if request.GET.supplier %} supplier = {{ request.GET.supplier }} & {% endif %} {% if request.GET.verified %} verified = {{ request.GET.verified }} & {% endif %} page = {{ page_obj.next_page_number }}">Next</a>
            {% endif %}

        </div>
    </table>
</body>
</html>